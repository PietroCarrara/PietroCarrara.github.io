<!--
    Shortcode to display a figure (supports video, audio and images)

    Arguments:
        - 0: The file path
        - Inner: The caption of the figure
-->

{{ $media := .Page.Resources.GetMatch (.Get 0) }}


{{ $caption := .Inner }}
{{ with $media }}
    {{ $fpath := .Permalink }}
    {{ $type := .ResourceType }}
    {{ $imWidth := 0 }}
    {{ $imHeight := 0 }}

    {{ if and (eq .ResourceType "image") (not (eq .MediaType.SubType "gif")) }}
        {{ $im := .Fit "600x460 webp" }}
        {{ $fpath = $im.Permalink }}
        {{ $imWidth = $im.Width }}
        {{ $imHeight = $im.Height }}
    {{ end }}

    {{ partial "elements/figure.html" (dict "fpath" $fpath "type" $type "caption" $caption "imWidth" $imWidth "imHeight" $imHeight) }}
{{ end }}
