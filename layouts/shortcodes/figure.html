<!--
    Shortcode to display a figure (supports videos and images)

    Arguments:
        - 0: The file path
        - Inner: The caption of the figure
-->

{{ $media := .Page.Resources.GetMatch (.Get 0) }}


{{ $caption := .Inner }}
{{ with $media }}
    {{ $fpath := .Permalink }}
    {{ $type := .ResourceType }}

    {{ if and (eq .ResourceType "image") (not (eq .MediaType.SubType "gif")) }}
        {{ $fpath = (.Fit "800x600 webp").Permalink }}
    {{ end }}

    {{ partial "elements/figure.html" (dict "fpath" $fpath "type" $type "caption" $caption) }}
{{ end }}
